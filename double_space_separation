import xlwings as xw

# Load the workbook and sheet
excel_file = 'your_excel_file.xlsx'
wb = xw.Book(excel_file)

# Replace 'CorrectSheetName' with the actual sheet name
sheet_name = 'CorrectSheetName'
sheet = wb.sheets[sheet_name]

# Function to export a range to PDF
def export_range_to_pdf(sheet, start_row, end_row, pdf_path):
    sheet.range((start_row, 1), (end_row, sheet.cells(start_row, 1).end('right').column)).api.ExportAsFixedFormat(0, pdf_path)

# Function to extract tables based on two empty rows and export them to PDFs
def extract_and_export_tables(sheet):
    current_table_start = 1
    empty_row_count = 0
    row = 1

    while True:
        row_values = sheet.range(f'{row}:{row}').value
        if row_values is None or all(cell is None for cell in row_values):
            empty_row_count += 1
        else:
            empty_row_count = 0

        if empty_row_count == 2:
            export_range_to_pdf(sheet, current_table_start, row - 2, f'table_{current_table_start}_{row - 2}.pdf')
            current_table_start = row + 1
            empty_row_count = 0

        row += 1
        if row > sheet.cells.last_cell.row:
            break

    if current_table_start <= sheet.cells.last_cell.row:
        export_range_to_pdf(sheet, current_table_start, sheet.cells.last_cell.row, f'table_{current_table_start}_{sheet.cells.last_cell.row}.pdf')

# Run the function
extract_and_export_tables(sheet)

print("All tables have been exported as PDFs with original formatting.")
